# å‘åŒ…è„šæœ¬ä½¿ç”¨æŒ‡å—

Kode é¡¹ç›®æä¾›äº†ä¸¤å¥—å‘åŒ…æµç¨‹ï¼Œä¸“æ³¨äºnpmå‘å¸ƒï¼Œä¸æ¶‰åŠgitæ“ä½œï¼š

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### å¼€å‘ç‰ˆæœ¬å‘å¸ƒ (æµ‹è¯•ç”¨)
```bash
npm run publish:dev
```

### æ­£å¼ç‰ˆæœ¬å‘å¸ƒ
```bash
npm run publish:release
```

## ğŸ“¦ å‘åŒ…ç­–ç•¥

### 1. å¼€å‘ç‰ˆæœ¬ (`dev` tag)
- **ç›®çš„**: å†…éƒ¨æµ‹è¯•å’Œé¢„å‘å¸ƒéªŒè¯
- **ç‰ˆæœ¬æ ¼å¼**: `1.1.16-dev.1`, `1.1.16-dev.2`
- **å®‰è£…æ–¹å¼**: `npm install -g @shareai-lab/kode@dev`
- **ç‰¹ç‚¹**:
  - è‡ªåŠ¨é€’å¢ dev ç‰ˆæœ¬å·
  - ä¸å½±å“æ­£å¼ç‰ˆæœ¬çš„ç”¨æˆ·
  - å¯ä»¥å¿«é€Ÿè¿­ä»£æµ‹è¯•
  - ä¸´æ—¶ä¿®æ”¹package.jsonï¼Œå‘å¸ƒåè‡ªåŠ¨æ¢å¤

### 2. æ­£å¼ç‰ˆæœ¬ (`latest` tag)
- **ç›®çš„**: é¢å‘æœ€ç»ˆç”¨æˆ·çš„ç¨³å®šç‰ˆæœ¬
- **ç‰ˆæœ¬æ ¼å¼**: `1.1.16`, `1.1.17`, `1.2.0`
- **å®‰è£…æ–¹å¼**: `npm install -g @shareai-lab/kode` (é»˜è®¤)
- **ç‰¹ç‚¹**:
  - è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶
  - ä¸¥æ ¼çš„å‘å¸ƒæµç¨‹
  - åŒ…å«å®Œæ•´çš„æµ‹è¯•å’Œæ£€æŸ¥
  - æ°¸ä¹…æ›´æ–°package.jsonç‰ˆæœ¬å·

## ğŸ› ï¸ è„šæœ¬åŠŸèƒ½è¯¦è§£

### å¼€å‘ç‰ˆæœ¬å‘å¸ƒ (`scripts/publish-dev.js`)

**è‡ªåŠ¨åŒ–æµç¨‹**:
1. ğŸ”¢ è¯»å–å½“å‰åŸºç¡€ç‰ˆæœ¬
2. ğŸ“Š æŸ¥è¯¢npmä¸Šç°æœ‰çš„devç‰ˆæœ¬ï¼Œè‡ªåŠ¨é€’å¢
3. ğŸ“ ä¸´æ—¶æ›´æ–°package.jsonç‰ˆæœ¬å·
4. ğŸ”¨ æ„å»ºé¡¹ç›®
5. ğŸ” è¿è¡Œé¢„å‘å¸ƒæ£€æŸ¥
6. ğŸ“¤ å‘å¸ƒåˆ°npmçš„`dev` tag
7. ğŸ”„ æ¢å¤package.jsonåˆ°åŸå§‹ç‰ˆæœ¬

**ä½¿ç”¨åœºæ™¯**:
- åŠŸèƒ½å¼€å‘å®Œæˆï¼Œéœ€è¦å†…éƒ¨æµ‹è¯•
- PRéªŒè¯å‰çš„æœ€ç»ˆæµ‹è¯•
- å¿«é€Ÿä¿®å¤éªŒè¯

**å®‰å…¨ç‰¹æ€§**:
- ä¸´æ—¶ä¿®æ”¹package.jsonï¼Œå‘å¸ƒåè‡ªåŠ¨æ¢å¤
- å¤±è´¥æ—¶è‡ªåŠ¨å›æ»š
- ä¸ä¼šæ”¹å˜æœ¬åœ°ç‰ˆæœ¬çŠ¶æ€

### æ­£å¼ç‰ˆæœ¬å‘å¸ƒ (`scripts/publish-release.js`)

**äº¤äº’å¼æµç¨‹**:
1. ğŸ“¦ æ˜¾ç¤ºå½“å‰ç‰ˆæœ¬
2. ğŸ”¢ é€‰æ‹©ç‰ˆæœ¬å‡çº§ç±»å‹:
   - **patch** (1.1.16 â†’ 1.1.17): ä¿®å¤ bug
   - **minor** (1.1.16 â†’ 1.2.0): æ–°åŠŸèƒ½
   - **major** (1.1.16 â†’ 2.0.0): ç ´åæ€§å˜æ›´
   - **custom**: è‡ªå®šä¹‰ç‰ˆæœ¬å·
3. âœ… æ£€æŸ¥ç‰ˆæœ¬æ˜¯å¦å·²åœ¨npmä¸Šå­˜åœ¨
4. ğŸ¤” ç¡®è®¤å‘å¸ƒä¿¡æ¯
5. ğŸ“ æ›´æ–°package.jsonç‰ˆæœ¬å·ï¼ˆæ°¸ä¹…ï¼‰
6. ğŸ§ª è¿è¡Œæµ‹è¯•å’Œç±»å‹æ£€æŸ¥
7. ğŸ”¨ æ„å»ºé¡¹ç›®
8. ğŸ” è¿è¡Œé¢„å‘å¸ƒæ£€æŸ¥
9. ğŸ“¤ å‘å¸ƒåˆ°npm (é»˜è®¤`latest` tag)
10. ğŸ’¡ æç¤ºåç»­gitæ“ä½œå»ºè®®

**å®‰å…¨ç‰¹æ€§**:
- äº¤äº’å¼ç¡®è®¤ï¼Œé¿å…è¯¯å‘å¸ƒ
- æ£€æŸ¥ç‰ˆæœ¬å†²çª
- æµ‹è¯•å¤±è´¥æ—¶è‡ªåŠ¨å›æ»šç‰ˆæœ¬å·
- æ°¸ä¹…ä¿ç•™ç‰ˆæœ¬æ›´æ”¹ä¾›gitæäº¤

## ğŸ¯ æœ€ä½³å®è·µ

### å¼€å‘æµç¨‹å»ºè®®
```bash
# 1. å¼€å‘åŠŸèƒ½
# ... å¼€å‘ä»£ç  ...

# 2. å‘å¸ƒå¼€å‘ç‰ˆæœ¬æµ‹è¯•
npm run publish:dev
# å®‰è£…æµ‹è¯•: npm install -g @shareai-lab/kode@dev

# 3. æµ‹è¯•é€šè¿‡åå‘å¸ƒæ­£å¼ç‰ˆæœ¬
npm run publish:release

# 4. æ‰‹åŠ¨å¤„ç†gitæ“ä½œï¼ˆå¦‚éœ€è¦ï¼‰
git add package.json
git commit -m "chore: bump version to x.x.x"
git tag vx.x.x
git push origin main
git push origin vx.x.x
```

### ç‰ˆæœ¬å·ç®¡ç†
- **å¼€å‘ç‰ˆ**: åŸºäºå½“å‰æ­£å¼ç‰ˆæœ¬è‡ªåŠ¨é€’å¢ (1.1.16-dev.1 â†’ 1.1.16-dev.2)
- **æ­£å¼ç‰ˆ**: éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/) è§„èŒƒ
- **ç‰ˆæœ¬æ£€æŸ¥**: è‡ªåŠ¨æ£€æŸ¥npmä¸Šæ˜¯å¦å·²å­˜åœ¨ç›¸åŒç‰ˆæœ¬

### æ ‡ç­¾ç®¡ç†
```bash
# æŸ¥çœ‹æ‰€æœ‰ç‰ˆæœ¬
npm view @shareai-lab/kode versions --json

# æŸ¥çœ‹ dev ç‰ˆæœ¬
npm view @shareai-lab/kode@dev version

# æŸ¥çœ‹æœ€æ–°æ­£å¼ç‰ˆæœ¬  
npm view @shareai-lab/kode@latest version
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**å‘å¸ƒå¤±è´¥æ€ä¹ˆåŠï¼Ÿ**
- å¼€å‘ç‰ˆæœ¬ï¼šè„šæœ¬ä¼šè‡ªåŠ¨å›æ»špackage.json
- æ­£å¼ç‰ˆæœ¬ï¼šæ£€æŸ¥é”™è¯¯ä¿¡æ¯ï¼Œä¿®å¤åé‡æ–°è¿è¡Œ

**ç‰ˆæœ¬å·å†²çªï¼Ÿ**
- å¼€å‘ç‰ˆæœ¬ä¼šè‡ªåŠ¨é€’å¢ï¼Œä¸ä¼šå†²çª
- æ­£å¼ç‰ˆæœ¬å‘å¸ƒå‰ä¼šæ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨

**æƒé™é—®é¢˜ï¼Ÿ**
- ç¡®ä¿å·²ç™»å½•npm: `npm whoami`
- ç¡®ä¿æœ‰åŒ…çš„å‘å¸ƒæƒé™: `npm owner ls @shareai-lab/kode`

**æµ‹è¯•å¤±è´¥ï¼Ÿ**
- æ­£å¼ç‰ˆæœ¬å‘å¸ƒä¼šè‡ªåŠ¨å›æ»šç‰ˆæœ¬å·
- ä¿®å¤æµ‹è¯•é—®é¢˜åé‡æ–°è¿è¡Œ

### æ‰‹åŠ¨æ“ä½œ
```bash
# æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·
npm whoami

# ç™»å½•npm
npm login

# æŸ¥çœ‹åŒ…ä¿¡æ¯
npm view @shareai-lab/kode

# æ‰‹åŠ¨å‘å¸ƒï¼ˆä¸æ¨èï¼‰
npm publish --tag dev  # å¼€å‘ç‰ˆæœ¬
npm publish            # æ­£å¼ç‰ˆæœ¬
```

## ğŸ“Š ç›‘æ§å’Œåˆ†æ

```bash
# æŸ¥çœ‹åŒ…ä¸‹è½½ç»Ÿè®¡
npm view @shareai-lab/kode

# æŸ¥çœ‹æ‰€æœ‰ç‰ˆæœ¬çš„è¯¦ç»†ä¿¡æ¯
npm view @shareai-lab/kode versions --json

# æµ‹è¯•å®‰è£…
npm install -g @shareai-lab/kode@dev
kode --version
```

## âš™ï¸ Gité›†æˆå»ºè®®

è™½ç„¶å‘åŒ…è„šæœ¬ä¸åŒ…å«gitæ“ä½œï¼Œä½†å»ºè®®çš„gitå·¥ä½œæµç¨‹ï¼š

**å¼€å‘ç‰ˆæœ¬å‘å¸ƒå**:
```bash
# å¼€å‘ç‰ˆæœ¬ä¸éœ€è¦gitæ“ä½œï¼Œpackage.jsonå·²è‡ªåŠ¨æ¢å¤
# ç»§ç»­å¼€å‘å³å¯
```

**æ­£å¼ç‰ˆæœ¬å‘å¸ƒå**:
```bash
# package.jsonå·²æ›´æ–°ç‰ˆæœ¬å·ï¼Œå»ºè®®æäº¤
git add package.json
git commit -m "chore: bump version to $(node -p "require('./package.json').version")"
git tag "v$(node -p "require('./package.json').version")"
git push origin main
git push origin --tags
```

---

é€šè¿‡è¿™å¥—çº¯npmå‘åŒ…ç³»ç»Ÿï¼Œä½ å¯ä»¥ï¼š
- ğŸš€ å¿«é€Ÿå‘å¸ƒå¼€å‘ç‰ˆæœ¬è¿›è¡Œå†…éƒ¨æµ‹è¯•
- ğŸ›¡ï¸ å®‰å…¨å‘å¸ƒæ­£å¼ç‰ˆæœ¬ç»™æœ€ç»ˆç”¨æˆ·  
- ğŸ“ˆ ä¿æŒæ¸…æ™°çš„ç‰ˆæœ¬ç®¡ç†
- âš¡ ä¸“æ³¨äºåŒ…å‘å¸ƒï¼Œgitæ“ä½œå®Œå…¨å¯æ§
- ğŸ”„ çµæ´»çš„ç‰ˆæœ¬å›æ»šå’Œæ¢å¤æœºåˆ¶